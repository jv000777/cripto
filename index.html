<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iXO - Cripto Monitor</title>
<link rel="icon" type="image/png" href="assets/A.PNG">
<style>
  body {
    background-color: #0d1117;
    color: #e6edf3;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    text-align: center;
  }
  header {
    padding: 20px;
  }
  header img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
  }
  h1 {
    margin: 10px 0 0 0;
    font-size: 28px;
  }
  h2 {
    margin: 5px 0 15px 0;
    font-size: 16px;
    color: #8b949e;
  }
  .last-update {
    font-size: 14px;
    color: #8b949e;
    margin-bottom: 15px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: auto;
  }
  th, td {
    padding: 12px 10px;
    text-align: left;
  }
  th.num, td.num {
    text-align: right;
  }
  thead th {
    font-size: 14px;
    color: #c9d1d9;
    border-bottom: 1px solid #30363d;
  }
  tbody tr {
    border-bottom: 1px solid #21262d;
  }
  tbody tr:hover {
    background-color: #161b22;
  }
  .chip {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: bold;
  }
  .green { color: #3fb950; background-color: rgba(63,185,80,0.1); }
  .red { color: #f85149; background-color: rgba(248,81,73,0.1); }

  /* Ajustes para móvil */
  @media (max-width: 480px) {
    thead th { font-size: 12px; }
    th, td { padding: 10px 6px; }
    .chip { font-size: 12px; padding: 3px 8px; }
    thead th.th-7d { display: table-cell; }
  }
</style>
</head>
<body>
<header>
  <img src="assets/A.PNG" alt="Logo iXO">
  <h1>iXO</h1>
  <h2>Cripto · Monitor</h2>
  <div class="last-update" id="lastUpdate"></div>
</header>

<table>
  <thead>
    <tr>
      <th>Activo / <span style="color:#cfd5ff">MC</span></th>
      <th class="num">Precio (USD)</th>
      <th class="num">24h</th>
      <th class="num th-7d">7d</th>
    </tr>
  </thead>
  <tbody id="cryptoTable"></tbody>
</table>

<script>
async function fetchData() {
  try {
    const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=50&page=1&sparkline=false&price_change_percentage=24h,7d');
    const data = await res.json();
    renderTable(data);
    document.getElementById('lastUpdate').textContent =
      'Última actualización: ' + new Date().toLocaleString('es-AR');
  } catch (error) {
    console.error('Error obteniendo datos:', error);
  }
}

function renderTable(data) {
  const tbody = document.getElementById('cryptoTable');
  tbody.innerHTML = '';
  data.forEach(coin => {
    const row = document.createElement('tr');
    const mc = 'MC: $' + formatMarketCap(coin.market_cap);
    row.innerHTML = `
      <td><strong>${coin.name}</strong><br><span style="color:#8b949e; font-size:12px">${mc}</span></td>
      <td class="num">$${formatPrice(coin.current_price)}</td>
      <td class="num">
        <span class="chip ${coin.price_change_percentage_24h >= 0 ? 'green' : 'red'}">
          ${coin.price_change_percentage_24h.toFixed(2)}%
        </span>
      </td>
      <td class="num">
        <span class="chip ${coin.price_change_percentage_7d_in_currency >= 0 ? 'green' : 'red'}">
          ${coin.price_change_percentage_7d_in_currency.toFixed(0)}
        </span>
      </td>
    `;
    tbody.appendChild(row);
  });
}

function formatPrice(num) {
  return num.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 8});
}

function formatMarketCap(num) {
  if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
  if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
  if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
  return num.toLocaleString();
}

fetchData();
setInterval(fetchData, 60000);
</script>
</body>
</html>