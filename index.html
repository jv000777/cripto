<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iXO - Cripto Monitor</title>
<link rel="stylesheet" href="style.css">
<style>
  body {
    background-color: #0b0e14;
    color: #fff;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 20px;
  }
  header img {
    width: 80px;
    height: auto;
    border-radius: 50%;
  }
  h1 {
    margin: 10px 0 0 0;
    font-size: 1.8em;
  }
  .subtitle {
    color: #aaa;
    margin-top: 4px;
  }
  .last-update {
    font-size: 0.85em;
    color: #888;
    margin-top: 6px;
  }
  .wrap {
    padding: 0 10px 20px;
  }
  .table-card {
    background-color: #141823;
    border-radius: 12px;
    padding: 10px;
    overflow: hidden;
  }
  /* NUEVO: scroll horizontal en móviles */
  .table-scroller {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    min-width: 640px; /* ancho mínimo para columnas completas */
  }
  th, td {
    padding: 12px 10px;
    text-align: left;
    border-bottom: 1px solid #222;
    white-space: nowrap;
  }
  th {
    color: #ccc;
    font-weight: 500;
  }
  td.num {
    text-align: right;
    font-variant-numeric: tabular-nums;
    white-space: nowrap; /* evita cortes */
  }
  .green {
    color: #2ecc71;
  }
  .red {
    color: #e74c3c;
  }
  @media (max-width: 430px) {
    table { min-width: 600px; }
    th, td { padding: 10px 8px; }
  }
  @media (max-width: 360px) {
    table { min-width: 560px; }
  }
</style>
</head>
<body>

<header>
  <img src="assets/A.PNG" alt="Logo iXO">
  <h1>iXO</h1>
  <div class="subtitle">Cripto · Monitor</div>
  <div class="last-update" id="lastUpdate">Última actualización: --</div>
</header>

<div class="wrap">
  <div class="table-card table-scroller">
    <table id="cryptoTable">
      <thead>
        <tr>
          <th>Activo / MC</th>
          <th class="num">Precio (USD)</th>
          <th class="num">24h</th>
          <th class="num">7d</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
const API_URL = "https://api.coingecko.com/api/v3/coins/markets";
const params = "?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=24h,7d";

async function fetchData() {
  try {
    const res = await fetch(API_URL + params);
    const data = await res.json();
    renderTable(data);
    document.getElementById("lastUpdate").textContent =
      "Última actualización: " + new Date().toLocaleString();
  } catch (err) {
    console.error("Error al obtener datos:", err);
  }
}

function renderTable(data) {
  const tbody = document.querySelector("#cryptoTable tbody");
  tbody.innerHTML = "";
  data.forEach(coin => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>
        <strong>${coin.name}</strong><br>
        <small>MC: $${formatNumber(coin.market_cap)}</small>
      </td>
      <td class="num">$${formatPrice(coin.current_price)}</td>
      <td class="num ${coin.price_change_percentage_24h >= 0 ? 'green':'red'}">
        ${formatPercent(coin.price_change_percentage_24h)}
      </td>
      <td class="num ${coin.price_change_percentage_7d_in_currency >= 0 ? 'green':'red'}">
        ${formatPercent(coin.price_change_percentage_7d_in_currency)}
      </td>
    `;
    tbody.appendChild(row);
  });
}

function formatNumber(num) {
  if (num >= 1e12) return (num / 1e12).toFixed(2) + "T";
  if (num >= 1e9) return (num / 1e9).toFixed(2) + "B";
  if (num >= 1e6) return (num / 1e6).toFixed(2) + "M";
  return num.toLocaleString();
}

function formatPrice(price) {
  return price >= 1 ? price.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}) :
    price.toPrecision(4);
}

function formatPercent(pct) {
  return (pct > 0 ? "+" : "") + pct.toFixed(2) + "%";
}

fetchData();
setInterval(fetchData, 60000);
</script>

</body>
</html>